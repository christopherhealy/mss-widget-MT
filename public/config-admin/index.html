<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>MSS Widget – Configuration</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <!-- Main MSS theme -->
  <link rel="stylesheet" href="/themes/MSSStylesheet.css?v=1" />
  <!-- Config-admin specific styles -->
  <link rel="stylesheet" href="/themes/mss-config-admin.css?v=1" />
</head>
<body class="mss-config-body">
  <div class="mss-config-shell">
    <!-- Header -->
    <header class="mss-config-header">
      <div class="mss-config-brand">
        <div class="mss-config-mark">MSS</div>
        <div>
          <div class="mss-config-brand-main">MSS Widget Admin</div>
          <div class="mss-config-brand-sub">
            Configure your school’s speaking practice widget
          </div>
        </div>
      </div>

      <div class="mss-config-school-chip">
        School: <span id="schoolSlugLabel">–</span>
      </div>
    </header>

    <!-- Nav -->
    <nav class="mss-config-nav">
      <a id="navConfig" class="mss-config-nav-item mss-config-nav-item-active" href="#">
        Configuration
      </a>
      <a id="navQuestions" class="mss-config-nav-item" href="#">
        Questions
      </a>
      <a id="navReports" class="mss-config-nav-item" href="#">
        Reports
      </a>
    </nav>

    <!-- Main content -->
    <main class="mss-config-main">
      <!-- Left column: configuration form -->
      <section class="mss-config-card">
        <h1 class="mss-config-title">Widget configuration</h1>
        <p class="mss-config-intro">
          Control how your widget looks and behaves. Question text is managed
          in the <strong>Questions</strong> section.
        </p>

        <form id="configForm" class="mss-config-form">
          <!-- Branding & text -->
          <section class="mss-config-section">
            <h2 class="mss-config-section-title">Brand & text</h2>

            <label class="mss-config-field">
              <span>Headline</span>
              <input
                id="headlineInput"
                type="text"
                placeholder="CEFR Assessment"
              />
            </label>

            <label class="mss-config-field">
              <span>Powered by label</span>
              <input
                id="poweredByLabelInput"
                type="text"
                placeholder="Powered by MSS Vox"
              />
            </label>

            <div class="mss-config-field-row">
              <label class="mss-config-checkbox">
                <input id="editableHeadlineInput" type="checkbox" />
                <span>Allow headline editing in future (keep flexible)</span>
              </label>
            </div>
          </section>

          <!-- Theme & behaviour -->
          <section class="mss-config-section">
            <h2 class="mss-config-section-title">Theme & behaviour</h2>

            <label class="mss-config-field">
              <span>Theme</span>
              <select id="themeSelect">
                <option value="MSSStylesheet">MSS (Blue)</option>
                <option value="apple">Apple-style light</option>
                <option value="dark">Dark</option>
              </select>
            </label>

            <div class="mss-config-field-row">
              <label class="mss-config-checkbox">
                <input id="permitUploadInput" type="checkbox" />
                <span>Allow students to upload audio files</span>
              </label>
            </div>

            <div class="mss-config-field-row">
              <label class="mss-config-inline">
                <span>Min recording length (seconds)</span>
                <input id="audioMinInput" type="number" min="5" step="1" />
              </label>

              <label class="mss-config-inline">
                <span>Max recording length (seconds)</span>
                <input id="audioMaxInput" type="number" min="10" step="1" />
              </label>
            </div>
          </section>

          <!-- API & logging -->
          <section class="mss-config-section">
            <h2 class="mss-config-section-title">MSS API & logging</h2>

            <label class="mss-config-field">
              <span>API base URL</span>
              <input
                id="apiBaseInput"
                type="url"
                placeholder="https://app.myspeakingscore.com"
              />
            </label>

            <label class="mss-config-field">
              <span>API key</span>
              <input
                id="apiKeyInput"
                type="text"
                placeholder="Paste your MSS API key"
              />
            </label>

            <label class="mss-config-field">
              <span>API secret</span>
              <input
                id="apiSecretInput"
                type="password"
                placeholder="Paste your MSS API secret"
              />
            </label>

            <div class="mss-config-field-row">
              <label class="mss-config-checkbox">
                <input id="loggerEnabledInput" type="checkbox" />
                <span>Enable logging of scores & transcripts</span>
              </label>
            </div>

            <label class="mss-config-field">
              <span>Logger URL (optional)</span>
              <input
                id="loggerUrlInput"
                type="url"
                placeholder="Leave blank to use MSS default logger"
              />
            </label>
          </section>

          <!-- Billing / usage limit -->
          <section class="mss-config-section">
            <h2 class="mss-config-section-title">Usage limit (per day)</h2>

            <label class="mss-config-field">
              <span>Daily test limit</span>
              <input
                id="dailyLimitInput"
                type="number"
                min="0"
                step="1"
                placeholder="0 = no limit"
              />
            </label>

            <div class="mss-config-field-row">
              <label class="mss-config-checkbox">
                <input id="autoBlockOnLimitInput" type="checkbox" />
                <span>Automatically block the widget when the limit is reached</span>
              </label>
            </div>

            <div class="mss-config-field-row">
              <label class="mss-config-checkbox">
                <input id="notifyOnLimitInput" type="checkbox" />
                <span>Email me when we hit the daily limit</span>
              </label>
            </div>

            <label class="mss-config-field">
              <span>Notification email</span>
              <input
                id="emailOnLimitInput"
                type="email"
                placeholder="admin@your-school.edu"
              />
            </label>
          </section>

          <!-- Actions -->
          <div class="mss-config-actions">
            <button type="button" id="resetBtn" class="mss-config-btn-secondary">
              Reset to defaults
            </button>
            <button type="submit" id="saveBtn" class="mss-config-btn-primary">
              Save configuration
            </button>
          </div>

          <p id="statusText" class="mss-config-status"></p>
        </form>
      </section>

      <!-- Right column: live preview hint -->
      <aside class="mss-config-card mss-config-preview-card">
        <h2 class="mss-config-section-title">Widget preview</h2>
        <p class="mss-config-preview-copy">
          This panel shows how your widget will feel to students on your site.
        </p>
        <p class="mss-config-preview-copy">
          Changes saved here will affect:
        </p>
        <ul class="mss-config-preview-list">
          <li>Headline & powered-by text</li>
          <li>Theme & button behavior</li>
          <li>Recording limits</li>
          <li>Whether uploads are allowed</li>
        </ul>
        <p class="mss-config-preview-copy">
          Question text and ordering are managed separately on the
          <strong>Questions</strong> tab.
        </p>

        <div class="mss-config-preview-placeholder">
          <span>Widget preview coming soon</span>
        </div>
      </aside>
    </main>
  </div>

  <!-- Small inline script to wire nav links with ?slug= -->
  <script>
    (function () {
      const params = new URLSearchParams(window.location.search);
      const slug = params.get("slug") || "mss-demo";

      const slugLabel = document.getElementById("schoolSlugLabel");
      if (slugLabel) slugLabel.textContent = slug;

      const navConfig = document.getElementById("navConfig");
      const navQuestions = document.getElementById("navQuestions");
      const navReports = document.getElementById("navReports");

      const q = "?slug=" + encodeURIComponent(slug);

      if (navConfig) navConfig.href = "/config-admin/" + q;
      if (navQuestions) navQuestions.href = "/questions-admin/" + q;
      if (navReports) navReports.href = "/reports-admin/" + q;
    })();
  </script>

  <!-- Main config logic -->
  <script src="/config-admin/config-admin.js?v=1"></script>
</body>
</html>